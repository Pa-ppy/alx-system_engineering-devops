#!/usr/bin/env bash
# Script that configures Nginx on a new Ubuntu machine with a custom HTTP response header

set -e

# Update package list and install Nginx
apt-get -y update
apt-get -y install nginx

# Add the custom header to the Nginx configuration
NGINX_CONF="/etc/nginx/sites-available/default"
sed -i "/server_name _;/a \\    add_header X-Served-By \"$(hostname)\";" "$NGINX_CONF"

# Restart Nginx to apply changes
service nginx restart

echo "Nginx has been configured with a custom header X-Served-By."
